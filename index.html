<!-- <!doctype html>
 #####ene ovliin zuragtai template
<html lang="mn">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />+
    <title>Гудамжны гэрэл + Цасны анимац</title>
    <style>
      :root {
        --sky-top: #0a0f1f;
        --sky-bottom: #1b2947;
        --ground: #0d1426;
        --lamp-metal: #4c566a;
        --lamp-glow: 255, 236, 179; /* rgb for lamp glow */
        --snow-count: 220; /* initial flake count */
      }

      * { box-sizing: border-box; }
      html, body { height: 100%; }
      body {
        margin: 0;
        height: 100%;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        background: url('snowfall1.jpg') no-repeat center center fixed;
        background-size: cover;
        overflow: hidden;
      }

      /* Scene Wrapper */
      .scene {
        position: relative;
        height: 100vh;
        width: 100vw;
        display: grid;
        place-items: end center;
      }

      /* Subtle stars */
      .stars {
        position: absolute; inset: 0; pointer-events: none; opacity: .6;
        background-image:
          radial-gradient(2px 2px at 10% 20%, rgba(255,255,255,.7) 50%, transparent 60%),
          radial-gradient(1px 1px at 25% 60%, rgba(255,255,255,.8) 50%, transparent 60%),
          radial-gradient(1.5px 1.5px at 40% 30%, rgba(255,255,255,.5) 50%, transparent 60%),
          radial-gradient(1px 1px at 70% 50%, rgba(255,255,255,.6) 50%, transparent 60%),
          radial-gradient(1.5px 1.5px at 85% 15%, rgba(255,255,255,.5) 50%, transparent 60%),
          radial-gradient(2px 2px at 90% 70%, rgba(255,255,255,.7) 50%, transparent 60%);
        background-repeat: no-repeat;
      }

      /* Ground */
      .ground {
        position: absolute; left: 0; right: 0; bottom: 0; height: 28vh;
        background:
          radial-gradient(60vw 20vh at 50% 0%, rgba(255,255,255,.05), transparent 60%),
          linear-gradient(to top, var(--ground), transparent 80%);
      }
      /* Snow */
      #snow { position: absolute; inset: 0; pointer-events: none; }
      .flake {
        position: fixed; top: -10px;
        width: var(--size); height: var(--size);
        background: radial-gradient(circle at 40% 40%, #fff 0 45%, rgba(255,255,255,.6) 60%, rgba(255,255,255,0) 70%);
        border-radius: 50%; opacity: var(--opacity);
        filter: drop-shadow(0 0 2px rgba(255,255,255,.4));
        animation:
          fall var(--fall) linear var(--delay) infinite,
          sway var(--sway) ease-in-out var(--delay) infinite;
      }
      @keyframes fall {
        to { transform: translateY(110vh) translateX(0); }
      }
      @keyframes sway {
        0%, 100% { margin-left: 0; }
        50% { margin-left: var(--wind); }
      }

      /* UI Controls */
      .controls {
        position: fixed; top: 16px; right: 16px;
        background: rgba(13,20,38,.6);
        backdrop-filter: blur(8px);
        border: 1px solid rgba(255,255,255,.08);
        border-radius: 16px; padding: 10px 12px; display: flex; gap: 10px; align-items: center;
        box-shadow: 0 6px 24px rgba(0,0,0,.25);
      }
      .controls label { font-size: 12px; opacity: .9; }
      .controls input[type="range"] { width: 140px; }
      .controls button {
        border: none; padding: 8px 12px; border-radius: 12px; cursor: pointer;
        background: rgba(255,255,255,.08); color: #e5e9f0; font-weight: 600;
      }
      .controls button:hover { background: rgba(255,255,255,.14); }

      /* Mobile tweaks */
      @media (max-width: 640px) {
        .arm { width: 120px; }
        .lamp { left: calc(50% + 116px); }
        .cone { left: calc(50% + 100px); width: 260px; transform: rotate(18deg); }
        .halo { left: calc(50% + 170px); width: 200px; }
      }
    </style>
  </head>
  <body>
    <div class="scene" role="img" aria-label="Шөнийн тэнгэр, гудамжны гэрэл, цас бударч байна">
      <div class="stars"></div>
      <div id="snow" aria-hidden="true"></div>

      <div class="streetlight" aria-hidden="true">
        <div class="arm"></div>
      </div>
      <div class="lamp" aria-hidden="true"></div>
      <div class="cone" aria-hidden="true"></div>
      <div class="halo" aria-hidden="true"></div>
      <div class="ground" aria-hidden="true"></div>
    </div>

    <div class="controls">
      <label for="density">Цас: <span id="densityValue">220</span></label>
      <input id="density" type="range" min="40" max="600" value="220" />
      <button id="windBtn" type="button">Салхи ↔</button>
    </div>

    <script>
      const snowRoot = document.getElementById('snow');
      const densityInput = document.getElementById('density');
      const densityValue = document.getElementById('densityValue');
      const windBtn = document.getElementById('windBtn');

      let windDirection = 1; // 1 => баруун тийш, -1 => зүүн тийш

      function rand(min, max) { return Math.random() * (max - min) + min; }

      function spawnFlakes(count) {
        const frag = document.createDocumentFragment();
        for (let i = 0; i < count; i++) {
          const f = document.createElement('span');
          f.className = 'flake';
          const size = rand(5.5, 7.5); // px
          const fall = rand(6, 13); // s
          const sway = rand(3.5, 8.5); // s
          const delay = rand(-fall, 0); // start at random positions
          const left = rand(-5, 105); // vw, start slightly outside edges
          const wind = rand(12, 38) * windDirection; // px side drift
          const opacity = rand(.55, 1);

          f.style.setProperty('--size', size + 'px');
          f.style.setProperty('--fall', fall + 's');
          f.style.setProperty('--sway', sway + 's');
          f.style.setProperty('--delay', delay + 's');
          f.style.left = left + 'vw';
          f.style.setProperty('--wind', wind + 'px');
          f.style.setProperty('--opacity', opacity);

          frag.appendChild(f);
        }
        snowRoot.appendChild(frag);
      }

      function resetSnow(count) {
        snowRoot.innerHTML = '';
        spawnFlakes(count);
      }

      // initialize
      const initial = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--snow-count')) || 220;
      resetSnow(initial);

      densityInput.addEventListener('input', (e) => {
        const val = parseInt(e.target.value, 10);
        densityValue.textContent = val;
        resetSnow(val);
      });

      windBtn.addEventListener('click', () => {
        windDirection *= -1; // flip
        // update existing flakes with new wind on the fly
        document.querySelectorAll('.flake').forEach(f => {
          const current = parseFloat(getComputedStyle(f).getPropertyValue('--wind')) || 20;
          const mag = Math.abs(current);
          f.style.setProperty('--wind', (mag * windDirection) + 'px');
        });
      });

      // Performance: recycle flakes when they leave viewport (optional but nice)
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (!entry.isIntersecting && entry.boundingClientRect.top > window.innerHeight) {
            const f = entry.target;
            // respawn at top with new randoms
            const size = rand(1.5, 4.5);
            const fall = rand(6, 13);
            const sway = rand(3.5, 8.5);
            const delay = 0;
            const left = rand(-5, 105);
            const wind = rand(12, 38) * windDirection;
            const opacity = rand(.55, 1);
            f.style.setProperty('--size', size + 'px');
            f.style.setProperty('--fall', fall + 's');
            f.style.setProperty('--sway', sway + 's');
            f.style.setProperty('--delay', delay + 's');
            f.style.left = left + 'vw';
            f.style.setProperty('--wind', wind + 'px');
            f.style.setProperty('--opacity', opacity);
            f.style.transform = 'translateY(-10px)';
          }
        });
      }, { root: null, threshold: 0 });

      // Observe flakes after initial spawn
      const startObserving = () => document.querySelectorAll('.flake').forEach(f => observer.observe(f));
      // Wait a tick so flakes exist, then observe
      setTimeout(startObserving, 50);
    </script>
  </body>
</html>
 -->

<!doctype html>
<html lang="mn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Манантай өвлийн шөнө — цас + хөгжим</title>
  <style>
    :root{
      --sky-top: #020617;
      --sky-mid: #071432;
      --sky-bottom: #0b2546;
      --mist: rgba(220,230,255,0.04);
      --vignette: rgba(0,0,8,0.5);
      --moon-glow: rgba(255,245,200,0.18);
      --snow-count: 220;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;overflow:hidden;font-family:system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial;}
    body{
      background:
        radial-gradient(1200px 500px at 50% 10%, rgba(15,25,60,0.45), transparent 30%),
        linear-gradient(180deg, var(--sky-top) 0%, var(--sky-mid) 45%, var(--sky-bottom) 100%);
      color:#e6eef8;
    }

    .scene{position:relative;width:100vw;height:100vh;overflow:hidden}

    /* Vignette */
    .vignette { position:absolute; inset:0; pointer-events:none;
      background: radial-gradient(60% 60% at 50% 40%, rgba(0,0,0,0) 0%, var(--vignette) 80%);
      mix-blend-mode: multiply; z-index:2;
    }

    /* Fog layer */
    .fog { position:absolute; left:-20%; top:5%; width:140%; height:50%;
      background: linear-gradient(90deg, rgba(255,255,255,0.02) 0%, rgba(255,255,255,0.03) 50%, rgba(255,255,255,0.01) 100%);
      filter: blur(22px); transform: translateY(0); opacity:0.95; animation: drift 28s linear infinite; pointer-events:none; z-index:4;
    }
    @keyframes drift { 0%{transform:translateX(-6%)} 50%{transform:translateX(6%)} 100%{transform:translateX(-6%)} }

    /* Small twinkling stars */
    .stars { position:absolute; inset:0; pointer-events:none; z-index:3; }
    .star { position:absolute; width:2px; height:2px; border-radius:50%; background:rgba(255,255,255,0.9); opacity:0.9; transform: translateZ(0);
      animation: twinkle linear infinite; }
    @keyframes twinkle { 0%{opacity:0.35} 50%{opacity:1} 100%{opacity:0.35} }

    /* moon + halo */
    .moon { position:absolute; top:7vh; right:14vw; width:120px; height:120px; border-radius:50%;
      background: radial-gradient(circle at 32% 30%, #fffaf0 0 55%, #f0e6bf 68%, rgba(200,180,120,0.9) 100%);
      box-shadow: 0 0 60px 28px var(--moon-glow), 0 0 18px 6px rgba(255,255,255,0.06) inset; filter: blur(0.4px); z-index:6; }
    .moon-halo { position:absolute; top:4.8vh; right:13.2vw; width:260px; height:260px; border-radius:50%;
      background: radial-gradient(circle, rgba(210,210,170,0.12) 0%, rgba(210,210,170,0.06) 45%, transparent 70%);
      filter: blur(18px); z-index:5; pointer-events:none; }

    /* Ground */
    .ground { position:absolute; left:0; right:0; bottom:0; height:28vh;
      background: linear-gradient(to top, rgba(8,12,20,1) 0%, rgba(8,12,20,0.6) 40%, transparent 100%); z-index:4; }

    /* Snow */
    #snow{position:absolute;inset:0;pointer-events:none;z-index:10}
    .flake{ position:fixed; top:-10px; width:var(--size); height:var(--size); border-radius:50%;
      background: radial-gradient(circle at 40% 40%, #fff 0 45%, rgba(220,235,255,0.75) 60%, rgba(220,235,255,0.15) 75%, transparent 85%);
      opacity:var(--opacity);
      filter: drop-shadow(0 0 6px rgba(210,230,255,0.06)) drop-shadow(0 0 2px rgba(255,255,255,0.04));
      animation: fall var(--fall) linear var(--delay) infinite, sway var(--sway) ease-in-out var(--delay) infinite; }
    @keyframes fall{ to { transform: translateY(115vh) translateX(0); } }
    @keyframes sway{ 0%,100%{margin-left:0} 50%{margin-left:var(--wind);} }

    /* Controls */
    .controls {
      position: fixed; top: 16px; right: 16px; z-index:60;
      background: rgba(8,12,20,0.55); backdrop-filter: blur(6px);
      border-radius: 12px; padding: 8px 10px; display:flex; gap:8px; align-items:center;
      color:#eaf4ff; font-size:13px; box-shadow: 0 6px 20px rgba(0,0,0,0.35);
    }
    .controls input[type="range"]{ width:140px }
    .playBtn { border:none; background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02)); color:#eaf4ff; padding:6px 10px; border-radius:8px; cursor:pointer; }
    .playBtn:hover{ filter:brightness(1.05) }
    .label { font-size:12px; opacity:0.95 }

    @media (max-width:640px){
      .moon{ width:90px; height:90px; right:6vw; top:6vh; }
      .moon-halo{ width:180px; height:180px; right:5.6vw; top:5.4vh; }
    }
  </style>
</head>
<body>
  <div class="scene" role="img" aria-label="Манантай өвлийн шөнө — цас бударч байна">
    <div class="vignette"></div>
    <div class="fog"></div>
    <div class="stars" id="starsLayer"></div>

    <div class="moon-halo"></div>
    <div class="moon"></div>

    <div id="snow"></div>
    <div class="ground"></div>
  </div>

  <div class="controls">
    <div class="label">Цас: <strong id="densityValue">220</strong></div>
    <input id="density" type="range" min="40" max="600" value="220" />
    <button id="windBtn" class="playBtn">Салхи ↔</button>
    <button id="musicToggle" class="playBtn">Play Music</button>
  </div>

  <!-- Audio: put your mp3 in music/cozy-jazz.mp3 -->
  <audio id="bgMusic" loop preload="auto">
    <source src="music.mp3" type="audio/mpeg">
  </audio>

  <script>
    /* ====== Stars: spawn many tiny stars with random positions & twinkle durations ====== */
    (function makeStars(){
      const starsLayer = document.getElementById('starsLayer');
      const count = 38; // small twinkling stars
      for(let i=0;i<count;i++){
        const s = document.createElement('div');
        s.className = 'star';
        const left = Math.random()*100;
        const top = Math.random()*50; // mostly upper half
        const size = (Math.random()*1.6) + 0.6;
        const delay = Math.random()*6;
        const dur = 2 + Math.random()*3;
        s.style.left = left + 'vw';
        s.style.top = top + 'vh';
        s.style.width = size + 'px';
        s.style.height = size + 'px';
        s.style.animationDuration = dur + 's';
        s.style.animationDelay = delay + 's';
        s.style.opacity = 0.6 + Math.random()*0.5;
        starsLayer.appendChild(s);
      }
    })();

    /* ====== Snow spawn & controls ====== */
    const snowRoot = document.getElementById('snow');
    const densityInput = document.getElementById('density');
    const densityValue = document.getElementById('densityValue');
    const windBtn = document.getElementById('windBtn');
    let windDirection = 1;

    function rand(min,max){ return Math.random()*(max-min)+min; }

    function spawnFlakes(count){
      const frag = document.createDocumentFragment();
      for(let i=0;i<count;i++){
        const f = document.createElement('span');
        f.className = 'flake';
        const size = rand(2.4,6.4);
        const fall = rand(6.5,14);
        const sway = rand(3.2,9.2);
        const delay = rand(-fall,0);
        const left = rand(-8,108);
        const wind = rand(8,44) * windDirection;
        const opacity = rand(.45,1);

        f.style.setProperty('--size', size + 'px');
        f.style.setProperty('--fall', fall + 's');
        f.style.setProperty('--sway', sway + 's');
        f.style.setProperty('--delay', delay + 's');
        f.style.left = left + 'vw';
        f.style.setProperty('--wind', wind + 'px');
        f.style.setProperty('--opacity', opacity);

        frag.appendChild(f);
      }
      snowRoot.appendChild(frag);
    }

    function resetSnow(count){
      snowRoot.innerHTML = '';
      spawnFlakes(count);
    }

    resetSnow(parseInt(getComputedStyle(document.documentElement).getPropertyValue('--snow-count')) || 220);

    densityInput.addEventListener('input', (e) => {
      const v = parseInt(e.target.value,10);
      densityValue.textContent = v;
      resetSnow(v);
    });

    windBtn.addEventListener('click', () => {
      windDirection *= -1;
      document.querySelectorAll('.flake').forEach(f => {
        const cur = parseFloat(getComputedStyle(f).getPropertyValue('--wind')) || 20;
        const mag = Math.abs(cur);
        f.style.setProperty('--wind', (mag * windDirection) + 'px');
      });
    });

    /* ====== Audio: play on first user interaction + static volume 0.4 + fade-in ====== */
    const music = document.getElementById('bgMusic');
    const musicToggle = document.getElementById('musicToggle');
    let fading = null;

    // set base volume to 0 (we'll fade to 0.4 on first play)
    music.volume = 0;

    // on first interaction, attempt to play and fade to 0.4
    document.addEventListener('click', () => {
      if (music.paused) {
        music.play().then(()=> {
          fadeVolume(music, 0.4, 1600); // fade to 0.4 in 1600ms
          musicToggle.textContent = 'Pause Music';
        }).catch(()=> {
          // autoplay blocked; user can use the button
        });
      }
    }, { once: true, capture: true });

    // toggle button
    musicToggle.addEventListener('click', (e) => {
      e.stopPropagation();
      if (music.paused) {
        music.play().then(()=> {
          fadeVolume(music, 0.4, 1200);
          musicToggle.textContent = 'Pause Music';
        }).catch(()=> { /* blocked */ });
      } else {
        // fade out quickly then pause
        fadeVolume(music, 0, 600, ()=> { music.pause(); musicToggle.textContent = 'Play Music'; });
      }
    });

    // fade helper: targetVol 0..1, duration ms
    function fadeVolume(audioEl, targetVol, duration=1000, cb){
      if (fading) clearInterval(fading);
      const start = audioEl.volume;
      const diff = targetVol - start;
      if (Math.abs(diff) < 0.01) { audioEl.volume = targetVol; if(cb) cb(); return; }
      const steps = Math.max(8, Math.round(duration/50));
      let step = 0;
      fading = setInterval(()=> {
        step++;
        const t = step/steps;
        // simple ease (smoothstep)
        const ease = t*t*(3-2*t);
        audioEl.volume = Math.max(0, Math.min(1, start + diff*ease));
        if (step >= steps) {
          clearInterval(fading);
          fading = null;
          audioEl.volume = targetVol;
          if (cb) cb();
        }
      }, duration/steps);
    }
  </script>
</body>
</html>






